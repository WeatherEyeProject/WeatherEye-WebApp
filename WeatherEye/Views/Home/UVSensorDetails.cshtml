@model WeatherEye.Models.UVSensor

@{
    ViewData["Title"] = "Szczegóły";
}
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js/dist/Chart.min.css">
</head>

<h2>Odczyty z czujnika UV</h2>
<h1>Szczegóły dnia @Model.DateOfReading.ToString("yyyy-MM-dd")</h1>

<div>
    <canvas id="myChart"></canvas>
</div>
</br>
<div id="outputDiv"></div>

<script>
    let dates = [];
    let uv = [];
    fetch('/api/sensors/S6/@Model.DateOfReading.ToString("yyyy-MM-dd")/@Model.DateOfReading.ToString("yyyy-MM-dd")')
        .then(response => {
            if (!response.ok) {
                throw new Error('Error fetching data from API');
            }
            //console.log(response);
            return response.json();
        })
        .then(data => {
            data.forEach(item => {
                dates.push(item.date);
                uv.push(item.value);
            })
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });

    console.log(dates);
    console.log(uv);

    let ctx = document.getElementById('myChart').getContext('2d');
    let chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: dates, // Dane na osi OX
            datasets: [{
                label: 'IlluminanceUV Data', // Etykieta wykresu
                data: uv, // Dane na osi OY
                backgroundColor: 'rgba(75, 192, 192, 0.2)', // Kolor wypełnienia wykresu
                fill: true,
                borderColor: 'rgba(75, 192, 192, 1)', // Kolor linii wykresu
                tension: 0.1 // Grubość linii wykresu
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

</script>

<a asp-action="UVSensorView">Powrót</a>